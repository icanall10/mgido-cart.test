!function(t){function a(t,a,e,n){if(null==t||!isFinite(t))throw new TypeError("number is not valid");if(!a){let e=t.toString().split(".").length;a=e>1?e:0}e||(e="."),n||(n=",");let i=(t=(t=parseFloat(t).toFixed(a)).replace(".",e)).split(e);return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),t=i.join(e)}function e(){t("[data-cart-block]").once().on("updateTotal",(function(){let e=t(this),n=0,i=[];e.find(".secrow2").each((function(){let a=t(this).find("[data-count]"),e=t(this).find("h3").text().replace(/\s{2,}/g," "),d=parseInt(a.attr("data-price")),o=parseInt(a.find("[data-value]").attr("data-value"));n+=d*o,o>0&&i.push(e+", "+o+" шт.")})),e.find("[data-total-value]").text(a(n,0,", "," ")),n>0?e.addClass("has"):e.removeClass("has"),t("[data-cart-input]").val(i.join("\n"))})),t("[data-cart-block] [data-add]").once().click((function(a){a.preventDefault(),t(this).closest("[data-count]").trigger("updateCount",[1])})),t("[data-cart-block] [data-count]").once().on("state",(function(){let a=t(this);0===parseInt(a.find("[data-value]").attr("data-value"))?a.removeClass("has"):a.addClass("has")})).on("updateCount",(function(e,n){let i=t(this);i.find("[data-value]").attr("data-value",n).text(a(n,0,", "," ")),i.trigger("state"),i.closest("[data-cart-block]").trigger("updateTotal")})).find("[data-plus], [data-minus]").once().click((function(a){a.preventDefault();let e=t(this),n=e.closest("[data-count]"),i=parseInt(n.find("[data-value]").attr("data-value"));e.is("[data-minus]")?i--:i++,i<0&&(i=0),e.trigger("updateCount",[i])}))}t(document).ready((function(){e()})),t(document).ajaxComplete((function(){e()}))}(jQuery);
